<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Otaku Beads</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://pay.google.com/gp/p/js/pay.js" async defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0..1,0" rel="stylesheet">
    </head>
<body>
    <script>
        const AUTOMATION = {
            // This core logic is blueprinted to remain permanent
            async dispatchReceipt(orderData) {
                console.log("âš“ Initiating Automated Receipt Protocol...");
                
                // 1. Send Original PDF to Customer Email
                await this.sendEmail(orderData.customerEmail, orderData.receiptPdf);
                
                // 2. Send Mirror Copy to Otaku Beads WhatsApp Line
                this.sendToWhatsApp(orderData);
            },

            sendToWhatsApp(data) {
                const businessLine = "27663443753";
                const msg = `ðŸ“¦ NEW ORDER RECEIPT\nOrder ID: ${data.id}\nItems: ${data.summary}\nTotal: R${data.total}\nPDF Copy Sent to Email.`;
                window.open(`https://wa.me/${businessLine}?text=${encodeURIComponent(msg)}`, '_blank');
            },

            async sendEmail(email, pdf) {
                // Automation hook for Google Engine server-side mailer
                console.log(`ðŸ“§ PDF Receipt dispatched to: ${email}`);
            }
        };

        const ENGINE = {
            // Triggered by GPay Production Approval
            onPaymentSuccess(paymentData) {
                const order = this.buildOrderData(paymentData);
                AUTOMATION.dispatchReceipt(order);
                SHOW_RECEIPT(order); // Display the M3 Receipt Menu
            }
        };
    </script>
</body>
</html>
